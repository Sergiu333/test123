<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geolocation Logger</title>
</head>
<body>
<h1>Geolocation Logger</h1>
<p>Datele despre locație sunt trimise automat către server.</p>

<script>
    // URL-ul endpoint-ului pe care l-ai creat pe server
    const apiUrl = '/api/geolocation';

    // Functie care trimite datele catre server
    function sendDataToServer(data) {
        fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then(response => response.json())
            .then(data => {
                console.log('Datele au fost trimise cu succes:', data);
            })
            .catch((error) => {
                console.error('Eroare la trimiterea datelor:', error);
            });
    }

    // Functie care inregistreaza locatia utilizatorului
    function logLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                const locationData = {
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent
                };

                console.log('Date despre locație:', locationData);

                // Trimitem datele catre server
                sendDataToServer(locationData);
            }, function(error) {
                console.error("Eroare la obtinerea locatiei: ", error);
            });
        } else {
            console.error("Geolocation nu este suportat de acest browser.");
        }
    }

    // Inregistram locatia imediat dupa deschiderea paginii
    window.onload = logLocation;
</script>
</body>
</html>
